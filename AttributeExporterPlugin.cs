using System;
using System.ComponentModel.Composition;
using System.Drawing;
using System.Windows.Forms;
using McTools.Xrm.Connection;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace AttributeExporterXrmToolBoxPlugin
{
    [Export(typeof(IXrmToolBoxPlugin))]
    [ExportMetadata("Name", "Attribute Metadata Exporter")]
    [ExportMetadata("Description", "Export attribute metadata from Dynamics 365/Power Platform to CSV")]
    [ExportMetadata("SmallImageBase64", "iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAATsSURBVFhHvVdpTFxVFL7MDHtZh4F57IPDOjAz0GHVNpWl0PKnxqLUFmprSUEBtwKVVq2k")]
    [ExportMetadata("BigImageBase64", "iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABGiSURBVHhe3V17dFXVmT8JAcMjGAyQBMiDEAmQkIQA1gEFtFSnFpcoTMc1y1ftUFsfU2stlfKqlSIu30Ntbauu2nFmOp3lqDPaqWVaOx3b4lCUgrqc8hDkoTwy9TESSG7uN+v7ztnn7vM73z7nJCB/9Kz18579Pff+nf06+96IV1LdtrOkur2zpKqts6SqNfg8yahWZEnyU4n+1oE5q27b6ZVUt30wcMw0GjimPYaSAChHGDvbFmWuOOiD+v7AFQfriPao12xD+dhpVFLd+j4T2CmK6rYArVRS3RZBQacjq40dz/bJmi9Jp8Wyy3iv2Wu+GD+UM5FVbUc87o42gb5Ta8wJYQd3JcqKrBVHe5Qn6TSZhpKgA2m+kXoKga1MYGtIIDubHpiW1NZpdq6GoE2SbaTCig/apwFjobyAKAe2X1guEOj3QN+AHc0Qjn5iUkRS5dL0WElNjjZZ4maRabk0e7SxCGztlEkxVNpzYOEek2oJUI8wNmhrV8zlg2XbR4urxdNkqMOYLn1kDowSGAcms4Nq93Ys9Emy1XwwhynbnyjTkGafVgeENQe2dQ6sNkPYNnL3PpfMts9S1uJhbNsPYyXdIzAO+iBQFytrPRCNjGNWaL6YHH1sX/vTFQ9joY0mx7IdC2MinDZhD7T2gZgQk3zUSMqJOiyjzKVPap9NEOpielyFNeO0RJpcK6NcA8ZMu0+KqelMfNvfJUNfLU4qgTGHDHDZ2fIkG2yMZo/lNLmtd8W09Vpd7c/QJpwDgyGMjv4i4l5IEEl2LjlCa0R/ocVIim9kyAP6hf7aHBh3Sn+ls6FV7FQha24XgVniREjGHojGWYO5yn3FifpnRVqeNH1o4yLQfkJpTysJ6Bd5eqcQfcmX1l6jjxJoLSK2QcQYgmDgk4WPIjY+OFe7bJ1tr+lFh+/CtjKK+GECljUZlj9KuBodNhbKmky7R58IcBuDQTFgX9Efv/74JPlj2SXLorP1BQKVObBPGBPA3KM+DbYP+mM5q+5E0Je4aQQmPg2t4Zgcy2kwD0PzQznm1HyS5CcI4cYftelvIqkIKllS1UrFlVNVDKhS9pNW49jXG9USgn1ihEG5aHQLeQzLj+OwjvN5o5oDeTMN4HiY3wLP84U4zRIbbQq2FoG4CquGVhlt2M+rmEzeaXXkDW+k4tFc2ZYYxGZwPXlDGqg4aKQd57Sx7VRWN52G1U2nsvoZNKS2A/LYva2dvBFNVMo+9TNpWP0M8Rs9aTYNrZtBA6taqXTcNIlj4g2umRavu4VBY9rF1tgPxfwWogQq78I2cUhiBNyQIQ1UNWk2Lb/jXtrwi1/Rlt9vo61bX6OtW1+NYONLm+mJHz1Fl115PXnlE8k7Y5L4c5yiskaae/EVtHf/Adr95m7at/8APfL4j6io7MxobiZwbLs8iJnzF9Mb/7Od9ux5i97c9SYdPHSYnt/wApXXdJA3qJau+9JKifOmxHubbln+TfGLtYHzlzfRlFkLaM/uPRKP/Z58+jkqOmNSbORE+EjrgbYTynzyxtP5C66gAwfepr5cz/5kA5XXTqeiMyYLKd6wCfTJTy+J2Dz305+LPJKbyStrpJrmObRv3/7AMi//fe/dd6nl7IvIO32ijIbbbr87Em/N3Q8JsfF2tIlP+9yFEfuX/nuz9HIkEDmIEWj3vJiDhaIRTTRh2nx6/733JGHPsS7qOX6MKN8bqYh/5am3+7jY5NiGiJ76t5/KkJe5atgEunDxZ0Ue0dsEyrCdRMOqW2nzK78Xm+6uLsnXdfQozbrg0+SV1vkkl9bRrSvXiU3PMT/e1+98kLzT3AS2zblE6tjb0y32v3rxt04Co0M4YRV2gpOW1tG3H/m7oJJdYUU7Dx+mnTt20Y4dOwW7du6i/Xv3EVEvUW9ObE0lZ1/0V+QNP1OIumBRAoFj2qmYJ/eyRnrmuZ+FOfO5HrlffPVN5A2sEfJM3XQC6/S2lBsCj1kEbowSaC94NoGyCjuOs2LJAvAKWVLZQq+++rpfSel5ebpn/fdpdLAAGAytm07Dazto/sKr6dDBQ9Ib80Eled7kXpHWA6WXDqqlv334ByEpue7jcv+lr60hr2QclVjbGSaqfwTaPRAIBG6iBFpvIi7YAXiZL5/wMdq/j3tWniifoz92dsoK5g1rlC2ADdlOeKNo/XcNAV3id+/6R0ICYz3wXwsEMkG8CIi++3hoc/9Djwqx0kirh/g98E4rV8IQZnu1B+pDOMJJf4cwEzKi8Ww6sJ8n8rwMpQ/ef48mnf1J8rxKGZZ+o8yPcdqoZPRUqpx8Dk099xJqOedi+Rw7dR6VVE71CVR7YKMMzUVX3SAyzmMI+eennyNvWIMMbdwSJfZAZWPdFwIjwCEcM3BANrmVU+n1198IKunPR3v37qO1d3+LZpx3qWxTuHfwBC2VGDvN74nlTVIx+RzZ7E/6Sg98+tnnyfNG0lnnX0ZHP/xQFovurqOi+/XGTVTKsWQVh3o7hvDSVXeR55X5+1Xu9QK+r5PRUdt6XuZFpJBLWYUROHwNOPH67z0eEmiGpVy9PbRp08u0as191DF3IRXxJtom0+QKeoNG4OP/8CSNqusItyvd/JB6c7T5la00uvFs6eWxOpt4EQK7qDeXow0//0+6bflamXeXr7mXlt9xn48199Gy1XfRg995THKb/H0ksPDjIgaShmUGbzJrW+bSwXcOSsJ8jz+8pDcGT1HkuW7a9LtX6OtrH6COeQv9TfTg8TSAvyoIhndsCOfz9Px//JJe+K/fhCSYofvAtx+TaUJWXIs0+x4JlO1OhosfEoOvtEXEz5fwJoJOMfC+rKyRJs28kJ559mfhqsgXE8hDR8i05bkeevHXL9FfXvM3QtoAft80BFo9kH3NQzDkccN4iOVyPfSJRdeSV1of74EBkECpi8QN7iMwMj+HeVAuAiOLaxKB2uobA5PIO/9hDdQ6+2IZstzbIj0wJLNACl/rH/6BPAB5iVcI9D8Le0Ymz8yBu3fvoXJe8c0cCAcNSKDpVWmXIZIvF4HYfuc+kIFlFbzCcqWZSJ7nKibTtDmX0Ipv3EO/3bjJ3yMGl3kbMUQu5PfioQ0qgSF5+Rw9/OgT1PXh/1FOHobfwB/+45NCVGE4FYCLCM+BPEqWfP5WeUe+7pYCPn/LKlpy4zK6fd2DlDt+PBxJSQRGh3DCIuIkkEkzx0XBPq9Ijp/a/U2vIXNEE02dtYCWrlxHv9m4SVZSrqQh4clnfiLv03ECu8KGrFx7v6ye96x/JCCkoLv8r2/232/tRUkhkK+lq4NVuLQuDm801bWdLw/YPNzMi4i2jcHhqxEpx0/1MwLMpCE1wfFP2BMMmU0+mafV0pdXrJWV2qx0W7Zso2J+AEPGR95ETKO/8+gT0kA+dCitbKFtwZuPeQc+cuQI1bTMlQdmD2WNQOdGGt5ECgS6e2DBN8NGWiPPP366kvYdeFuOgPYfeIf+/p+eEiLklSog0CaTtx3jWudFhvCrr73hz4GDx0e3Mfk8vbRpMxWVT6Qis1cc0kAf+8RfUK67m3p7esL58N83vCDTgByYGgIj78J+b1+dRGAfDxMKvilD2AWe/OdcfIUkMtf/dnbS2OY55HlV/uZUhkd9Ad4ZdMGiz1C+tzccgptf3kJFI6cIORfCPvDH//JsYaXlKYMfQsk4Wn3nA6KX1TOw/eKyOwqHCcoiwpdPILwLm22P+i58EgnEXuhVTKGq5jn0wbt/lKHkV7JXTl/W3f0tuvm2O+jGpbfTF768ij538wrBN9beT3vf2uv3nqBR0mv5lFrZSMePs9pkuA8Y0SSHs3xxL8zncvKmMuXPLpJXP+ntCoHOIRwsgPFXuZMwhO25EOdEHnaPPfHjsJKmoslXXhptKnnh4mvJGzohG4FBhVnWPOtT1HX0QyHPDGVepAaMmOgfewmB0cME5xCOEJi9B0q9wn2gg8AkFFdMppENZ9ErW7ZJQn+F1TapBry3K2yq5SRlaIP/MCLHWb5NjECzzwuGsr8g+YQb0nl4sy5KYMoiAgRmXUQKBCb0wETwxH76RCqvm0EPfe+HMgdmuXbt2k033bpa5tHwTWRoAy24/LqIHX+/YggOF6PgnhcMPs3+xS9fjPjw9eeLP0ueV0Er1twXkd91/8PkDaqJtsHMgaefSR3zLo3Y8w6BDzxcBPr+J0Igg0nkRWBwvSwg/L3GtTcuk80qb1CvC7Dkiyvoyi98Rb44KqudLouDf6gQEDKqmWpaz6fP3PQ1uvqG2+Rz/qXXiLxQWRv+8f7Ylrl0zY3L6Krrv0pXXb+Ulty8kj7OfuUTqHXOJRKHdfzZcd5lNKBicrwNfGA7uoVGNs2mq2/4Kl0T5P/U5Z8TOc7/EWRdRGKAHiG9qGKK/1bBi0K4+lor8eDx0ut44y25kBDelItdAD5tCY7owzx2fn54nNPYm7zlTf7RGR+nmXhcjxGTCgcQCP7KgHu1bV/mL0gxW/BLnAMT2eeuz43mHngqwaShLCvY1/hr91ZZvli3H5qG/vfAdnnS5RPOoqrmc6lyyjly2hwCy5PPdZen8H1QNvehzPazy657y1ZiaL6AiJ2P+o75VN0yV07LY20PEF1E+kKgfLE9nmZ+fBG9tXcfdR45QocPHqLDBw/S4UOMQz64bMPoIrLAVnSmbO4DaLZhDDtvUA5jQFzRQawwRsG2+9gx2rrtNWo/ZwEV85f/2P7YYYJynOVE8EpWPXGWfIMvF38PnAm5ACjvD1Li8FeoWexsfXCavnHTy9QwdV4f5kClB7rmvuKRzTR8bDv97mX/i+0/tYt/TjKIv37Qvi4AbuQlwybQ/EI1VAqsv5mtaqWi4WfSqjsfoHcOHqLt23fQ9u07A5j7HfQHxh+4HIWR82fBB/QBorELtqFNEF8+DYxvmHundW9BZNF679i1m76yap2/+lZMSSQvAtcQRkMj418wVUycRYNrOuTXTv6nhXEsMzA2dtn2QznqXbD8Ivkg7jjMYX2yX+jbIb/kko09/qQOOIhx4yIQjW1ZcWX0S/M/FSBJyAVyEiUQjvRtIwzwUQNzYvlkoK8xNftYD9TnwL6RmWaTpnchze9k6bG9tty2DREhUP2D62ggLYgm0+JgpRHog3FtG4QrD8rS7BBunfkbwpDA1uAv1vX/2YQrIJaTYGyx8dgITYa6LHbafV+R7guLCBKG0CqNZVuO9y4CkqD5I7AuLnu0S6ozyjSdQiAaxINhhbLIkuRoo9lpsiQ5AtuBbUKZplftcBvjK6zNsxLI3GsNwLIWwwWXHv21e7usxdPsk/wQLnmsB/qG2jCO/9F1evC4XvPNIkMdytLssNwf+P7ADfZATFpYbTRSoxWzPzEO6lwyLGtxknR2WfMxerRJihEv+0f8cp9OIDiADitnl/uDkxnDrqutK8gK33XYdnabNb/IvUZgFpggWEFEmh6h2dsVRx3aaPdaGWPZOVCXCDeBffv7YDsx3qOPC0mN0+Soc+V3lbPE0+wiZY1AdEa4bLASWEa5S58EuwEoQzu01ezQB2Wpeu1d2Ie+aLgCFWTJby6oy9o4DVl8sticELAH+oo4efjE7YbbQBtNhvo0O6yLJseyJtPKmDsNMVudwLix3SBMastQl+SPSIqHdli2Za77rNDq7tL7c6D1nQg6YhCtbH+inRZPs0+Lrdm7/JLkWp0Qmh7vQz32QDQwjmmypERYwSSdFttli3ZaGXNhTFveL71OYHQLowVCuRYcbWxbrazpMJ6WC8uos/Va/Cz+iNAmsgoHB6qYCANqSTV7LKPM9nH5o6yvwHyozwL0i5T1Hhh3wpXZNM5l72o8+mDZ5EKdrdd0aXDZo1yzQfuoTCEwbpQUwC1DOZZRjnpXWYuN9sYGZUk+LthxMF5hEbF+neUbxM8E7Uppcq2MPmiHORDoq8XGe/TT9JgDZahHhLpwGxP8YwQyppnIAKZsy2wdlo1M87FjoQ71Wvy+wBXDLqMO7Vz1jIL/MYI2+ccIdpRUtx9hNqNoVe5tWRLYLqvtCaBakZ0q+Jxt/3+5Ya8qbWsq+AAAAABJRU5ErkJggg==")]
    [ExportMetadata("BackgroundColor", "White")]
    [ExportMetadata("PrimaryFontColor", "Black")]
    [ExportMetadata("SecondaryFontColor", "Gray")]
    [ExportMetadata("IsOpenSource", true)]
    public class AttributeExporterPlugin : PluginBase, IGitHubPlugin
    {
        public string RepositoryName => "AttributeExporterXrmToolBoxPlugin";
        public string UserName => "HurleySk"; 

        public override IXrmToolBoxPluginControl GetControl()
        {
            return new AttributeExporterControl();
        }
    }
}
