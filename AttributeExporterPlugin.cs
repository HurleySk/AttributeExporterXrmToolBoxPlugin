using System;
using System.ComponentModel.Composition;
using System.Drawing;
using System.Windows.Forms;
using McTools.Xrm.Connection;
using XrmToolBox.Extensibility;
using XrmToolBox.Extensibility.Interfaces;

namespace AttributeExporterXrmToolBoxPlugin
{
    [Export(typeof(IXrmToolBoxPlugin))]
    [ExportMetadata("Name", "Attribute Metadata Exporter")]
    [ExportMetadata("Description", "Export attribute metadata from Dynamics 365/Power Platform to CSV")]
    [ExportMetadata("SmallImageBase64", "iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAI+SURBVDhPlZP9S1NRGMfP5IgpVGvWutfRmLXarrndu7JQYiG0ZLWRiYiSk0arpmauUMGVpIWJkkIvojlwFjozTRhUIGVUIJHFfAmN3vYf6C/1B3zj7lbbrFX+8OVwnvM8H845z/chlDF+pqywRBl+dRJrWP4Loazxa7LKhOQMIaHon/YqEyjLfyOUMS5FDlj+v0XFVQQx/HIcgCj0IOu2g6RnQabMBlFwUlyuA0nnInExl2zQRyCUjQGICdq9VljL3NDsOgj5tlxs3V0AslaLHEsJtHusUAsHQJXZ0OfZkKbOQRJjlAAi0WguRGj2HTq6ejHy4CHOXWhDS/tNlJ44j4HAOE56mtDa2QNC1uPRxDOoBQvIxiwJIFNw0Ofa8PrNDJrbbsBsKYH9WBU+fgpj8f0HkLRMFDrOIDS3gM7rPszNL0DJ7Y8C6GYDNu3Yh3x7BdxnvXg1HULjlS7Mzi9i8sUUrMUuHCp14+nzKRw/VYfptzNgdubH34DLs2Fi8iXar3VjaDSI6obLqG1sRSpjQPDxE1TVt8DjvQpCUjB0P4gtsU+gSgMYzgyXpwmXOrrhqGzA0YoaOGu8KChywuW5iMq6ZpS763GkvBqHy04jJUOIfmKSXIdiZy367o7ilm8Qt/3D8N0ZQa9/GP2DY+jpD0TUN3AP/sA4zHYHZGIrf/lAZZL6vEYDkioqM4E0Uo5cJzkx1kgRd/1DP8yT2IkrIT/3sYW/A/4yTCuHKC4eHSZDmLLCskhblcQalg9/B6CFnus1+IPwAAAAAElFTkSuQmCC")]
    [ExportMetadata("BigImageBase64", "iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAATsSURBVFhHvVdpTFxVFL7MDHtZh4F57IPDOjAz0GHVNpWl0PKnxqLUFmprSUEBtwKVVq2k/rCYmKJEKk0XJOJCDK6NRY2pJhp/1DSpIYRC0eIPEqBYo2X/zD0Pxpk3bxiqlZt8ee+ec+4535x7zr3zmEprHFIJ5gmV1jih0ppcYC02awSPKZiuMZVgvOUeng5VuBnu/zPsYkSkQyWY/mD8V5FSMBHcZSCV285X3ldbL6fnZFRa06QdAWeL5HRyNlI7W5nUxoGA1LErSB270jnYSQk4GNwFSH3aklkXAlKsewY41rwFdgvDzWAaA5iPDsw7VoRvHBShqdQ+LCgRzCsGyrC05bYygfnpSeYWmgoWyPWxUGmNpCN//vFg3jp7AoJcF3DjoCT46zKxo6IWe6obCCUPVcFDMEIRoIelsAz7648gUJ9DJNiGe5C/41HUHT6OKHMhMgvLsK/uOfjGWEivVKeg4IF92H3wEDwjzFASMScZUISkQKPPwU9XrkI6+r/+FgrvKLxy8i2aJ+aUgrFQbCs7QPPLV65iQ7AeZ7p7aR6WshlMnULZuPjVJWBxHj7RG8E0qY4ZWCHAjSsfbyIHdU0t0Kfdj/TcUnT1fAhgCTpLMZqOtZI+OD4PCRlFmJ2dxcDgNQRy5ywMp869CyzMIUifC+YXD6aKRG/f55iemiICfJtWJbD3icMU4GTHecSbC8DcI8E8oxFm2AwP/wS0nHgDiwvzsBTuxODQCK6P3oDOlE9bwdd3nO0hAvrMEgToshCgNeKTC19iamLCNQFFiAEh+hxc+u6H5cQDPw8M4ujx16BNuheMadDS2o6F+TmMjv5C+ta2TpK7R5ipENtOdZF8YXbGCj6Gh0dEAitbIFcDHrzKfeLAlOHYXLobbR3nMTb2GzkYHx+HOnYjGpe3YOavPzEwOIT5uVlkb31Y7BqvWLR3dgNLizjT/QHaO99G+5vnMHL9V4zdGJPLgMmOgDI4GdnF5dhb2yw6ZL5UaPvrmyno9l3VVO188KrWJuRh5vZtDA4Nw0cwEnGqgfk5akPGBDAWiJ7ejzE9dVOOgKQGPKKtv/B01/uoPPAMyitq0XH2HZJlFZej4YUT9B6RtoVSX/X08zTne8+Yv0hgaQGhyZvELvDWoe/TL/D7TZGAtQvktkChMSBYl4UL/d+QU9vR/V4f3LwiqQj54EXGAhLokPros36Sbdr+CF59/bQMgYu4Nb2cgdXaUKwBHZibQA50GUWIzSiCOiGPWowpBHhHZSA6vVA8/TxjwJQRdNLFZmylw8kzMh1RvCt846h7mHsUAuKyoc8qIf/iCSlXA/wU9NMjI/9B1DS2UDtW1DQS+PvBZ19ETcNLeOzJIySr5vNDx0hW9dRRknEdR2VNk52+vvll5JbsglKdbI3lkAG3oCQkZ23D5OSkJPn/fXz/42U6tBTqlH8IONyGGgOl+77SPbAU7ISloExEocxzBSs2zrBsR3dGYCIFdkqAtiDEIN5cdxluoeLNaXvpORCQ3t2285Uilc6dvUv9OMAZAdvAzhxLA0jlLoPfKYF/C6lPO79SAtLFtk5Wk8m92z7l9AQpATmmcjI5+Z2CfDgjIGVqK7eFM7kzONi7IiCFM4errVkVVgL845Sfz1xA/3AdPyblns7sbWVyc6u99eNUMA2rBPMkZ7Ou4DEF0/DfvUZ5YPZwXBcAAAAASUVORK5CYII=")]
    [ExportMetadata("BackgroundColor", "White")]
    [ExportMetadata("PrimaryFontColor", "Black")]
    [ExportMetadata("SecondaryFontColor", "Gray")]
    public class AttributeExporterPlugin : PluginBase, IGitHubPlugin
    {
        public string RepositoryName => "AttributeExporterXrmToolBoxPlugin";
        public string UserName => "HurleySk"; 

        public override IXrmToolBoxPluginControl GetControl()
        {
            return new AttributeExporterControl();
        }
    }
}
